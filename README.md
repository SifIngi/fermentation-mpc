# fermentation-mpc
Model predictive control (MPC) for fermentations

## Description
This program is used for modelling, optimizations and model driven control for fed batch fermentations. It is using a particular serine model based on
mass balances. The growth rates are calculated from online data (CER values) and are input in the model.
Then model simulation is computed, which can predict the compounds of interest until current time points. Afterwards, parameter estimation is made
which uses the previous simulated values, to fit a predictive model. This model is simulated, both with the original feeding values, and also with varying feeding parameters.
Plot of this is generated by plotly and the browser reloads every time there is new incoming online data. Visualization of the plots can be seen in the figure.
Smaller configurations has to be made, in order for it to work in a bioreactor setup.

![](/images/mpc.png)
From the first row the model simulation based on online data can be seen with the predictive model. Experimental data is also shown here.
The second row is future prediction on grams of serine, production rate and serine titer.

## Requirements
The project uses pipenv to handle virtual environment. <br />
Install pipenv here [pipenv installation](https://github.com/pypa/pipenv#installation)

## Installing

To activate the project
```
pipenv shell
```

Install the necessary dependencies
```
pipenv install
```

## Usage of the program

One can choose to use the modelprediction_CO2.py for only prediction or modelpredictionfeed_CO2,
which can predict and provide an optimal feeding strategy. Herunder example of how to use modelpredictionfeed_CO2.py is described.

#### Before running the script

Set correct path for project folder in parest_copasi, so the parameter task in Copasi can be executed.
Path for where the online data is located, has to be set in the modelpredictionfeed_CO2.py

```
watch_file = 'data/SER_C016_Reactor24_4g-LGlycine_0,02FeedRate.csv'

```

#### Simulation

#### Experimental data

#### Plot

#### Parameter estimation

#### Model driven prediction










